#!/usr/bin/env python
# -*- coding: utf-8 -*-

import cli.log

from ebimport.handlers import PortugalAvesHandler


@cli.log.LoggingApp(message_format="%(levelname)s: %(message)s")
def script(app):

    handlers = {
        'portugalaves': PortugalAvesHandler,
    }

    filein = app.params.filein
    fileout = app.params.fileout

    handler = handlers.get(app.params.format)()
    handler.load_resources()
    handler.convert_file(filein, fileout)


script.add_param("-f", "--format", dest='format', action="store",
                 help="format of the input file")

script.add_param("-o", "--output-file", dest='fileout', action="store",
                 default='ebird.csv',
                 help="file where the records to import into eBird are stored")

script.add_param("filein", type=str,
                 help="file containing records exported from WorldBirds")

if __name__ == "__main__":
    script.run()
